<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/content-slider/content-slider.html">
<link rel="import" href="need-words-avatar.html">
<link rel="import" href="need-words-logo.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/login-fire/login-fire.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="../../bower_components/app-route/app-route.html">
<link rel="import" href="../../bower_components/app-route/app-location.html">

<dom-module id="need-words-app">
  <template>
    <style>
      :host {
        display: block;
        --nw-yellow: #FFE164;
        --nw-blue: #79C9FF;
        --nw-darkblue: #38AFFF;
        --nw-grey: #E5E5E5;
        --nw-green: #47D6B0;
        --nw-darkgrey: #1E3746;

        --sans-serif-base: {
          font-family: 'Campton';
          font-weight: 600;
          text-rendering: optimizeLegibility;
          -webkit-font-smoothing: none;
          -moz-osx-font-smoothing: grayscale;
        }

        --serif-base: {
          font-family: 'Georgia';
          font-weight: 400;
          text-rendering: optimizeLegibility;
          -webkit-font-smoothing: none;
          -moz-osx-font-smoothing: grayscale;
        }

      }


      h2, h3, h6 {
        @apply --sans-serif-base;
        margin: 0;
      }

      h2 {
        font-size: 60px;
        line-height: 1.2;
      }

      h3 {
        font-size: 32px;
        line-height: 1.4;
      }

      h6 {
        font-size: 24px;
        line-height: 1.5;
      }

      .block {
        width: 100%;
        @apply --layout;
        align-items: center;
        justify-content: center;
        border: 8px solid transparent;
        box-sizing: border-box;
        color: var(--nw-darkgrey);
        position: relative;
      }

      .block:not(:last-of-type) {
        margin-bottom: 56px;        
      }

      .block.yellow {
        background-color: var(--nw-yellow);
      }

      .block.blue {
        background-color: var(--nw-blue);
        border-color: var(--nw-darkblue);
      }

      .block.grey {
        background-color: var(--nw-grey);
      }

      .block.green {
        background-color: var(--nw-green);
      }

      .block.blue {
        background-color: var(--nw-blue);
      }

      .block.blue::after {
        position: absolute;
        width: 8px;
        height: 112px;
        left: 50%;
        margin-left: -4px;
        top: -112px;
        background-color: var(--nw-darkblue);
        content: '';
      }

      .large-padding {
        padding: 24px 0 96px 0;
      }

      .double-padding {
        padding-bottom: 48px;
      }

      .block section {
        flex: 1;
        box-sizing: border-box;
        max-width: 1072px;
        padding: 40px 24px;
        @apply --layout-vertical;
      }

      .block section.horizontal {
        @apply --layout-horizontal;
      }

      article {
        @apply --serif-base;
        font-size: 30px;
        line-height: 1.6;
        margin: 40px 0;
      }

      ol {
        list-style: none;
        margin: 0;
        padding: 0;
        @apply --layout-horizontal;
        justify-content: space-between;
        margin: 40px 0;
      }

      li {
        margin: 0;
        padding: 0;
        max-width: calc(33.3333% - 26px);
        position: relative;
      }

      ol li article {
        margin: 0;
        font-size: 24px;
        line-height: 1.6;
      }

      ol li:not(:first-child):before {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 1px;
        left: -18px;
        background-color: white;
        content: '';
      }

      button {
        opacity: 1.00;

        background: var(--nw-yellow);
        box-shadow: 0px 6px 0px var(--nw-darkblue);
        color: var(--nw-darkblue);

        border-radius: 4px;

        @apply --sans-serif-base;
        font-size: 32px;
        line-height: 1;

        height: 72px;
        box-sizing: border-box;
        padding: 0 68px;
        border: 0;
        cursor: pointer;
        white-space: nowrap;
      }

      button.blue {
        background: var(--nw-darkblue);
        box-shadow: 0px 6px 0px white;
        color: white;
      }

      .flex2 {
        @apply --layout-flex-2;
        max-width: calc(66%);
        padding-right: 26px;
      }

      need-words-logo {
        margin-bottom: 96px;
      }

      content-slider {
        width: 100%;
        height: 400px;
        border: 0px solid red;
        position: relative;
        font-size: 24px;
        font-weight: bold;
        color: white;
        --content-slider-slide: {
          color: var(--nw-darkgrey);
        }
      }

      content-slider div {
      }

      blockquote {
        @apply --serif-base;
        font-style: italic;
        font-size: 48px;
        line-height: 1.3;
        padding: 0;
        margin: 0 0 26px 0;
      }

      blockquote:before {
        content: '‘';
      }

      blockquote:after {
        content: '’';
      }

      #testimonials-nav {
        list-style: none;
        margin: 0;
        padding: 0;
        @apply --layout;
        @apply --layout-center;
        @apply --layout-center-justified;
      }

      #testimonials-nav li {
        width: 16px;
        height: 16px;
        margin: 0 8px;
        padding: 0;
        background-color: var(--nw-grey);
        border-radius: 50%;
        font-size: 0;
        box-sizing: border-box;
        cursor: pointer;
      }

      #testimonials-nav li[data-active] {
        background-color: var(--nw-yellow);
        cursor: pointer;
      }

      input, textarea {
        background-color: white;
        border: 0;
        border-radius: 3px;
        padding: 5px 10px;
        width: 100%;
        height: 48px;
        margin-bottom: 36px;
        box-sizing: border-box;
        @apply --serif-base;
        font-size: 24px;
        line-height: 1.2;
        position: relative;
      }

      textarea {
        height: 131px;
      }
    </style>

    <app-location
      route="{{route}}"
    ></app-location>

    <app-route
      route="{{route}}"
      pattern="/login"
      active="{{loginPageActive}}"
    ></app-route>    

    <firebase-document
      path="/site-content"
      data="{{siteContent}}">
    </firebase-document>

    <template is="dom-if" if="[[loginPageActive]]">
      <paper-button hidden$="[[signedIn]]" on-tap="_openAuthDialog">Sign in</paper-button>
      <paper-button hidden$="[[!signedIn]]" on-tap="_signOut">Sign out</paper-button>

      <paper-dialog
        id="auth-dialog"
        always-on-top
        >
        <login-fire id="firebase-auth" horizontal email-password google user="{{user}}" signed-in="{{signedIn}}"></login-fire>
        <div class="buttons">
          <paper-button dialog-dismiss>Cancel</paper-button>
        </div>
      </paper-dialog>
    </template>
    

<!--     <div class="block blue" id="intro">
      <section class="horizontal">
        <header class="flex2">
          <h3 contenteditable$="[[signedIn]]">{{siteContent.intro}}</h3>
        </header>
        <footer>
          <button contenteditable$="[[signedIn]]">{{siteContent.introButton}}</button>
        </footer>
      </section>
    </div> -->

    <div class="block yellow large-padding" id="header">
      <section>
        <header>
          <need-words-logo></need-words-logo>
          <h2 contenteditable$="[[signedIn]]">{{siteContent.header}}</h2>
        </header>
        <main></main>
        <footer></footer>
      </section>
    </div>

    <div class="block blue" id="call-me">
      <section class="horizontal">
        <header class="flex2">
          <h3 contenteditable$="[[signedIn]]">{{siteContent.callMe}}<br>{{siteContent.callNumber}}</h3>
        </header>
        <footer>
          <button contenteditable$="[[signedIn]]">{{siteContent.callAlternative}}</button>          
        </footer>
      </section>
    </div>

    <div class="block yellow" id="why">
      <section>
        <header>
          <h2 contenteditable$="[[signedIn]]">{{siteContent.whyHeader}}</h2>
        </header>
        <main>
          <article contenteditable$="[[signedIn]]">
            {{siteContent.whyArticle}}
          </article>
        </main>
        <footer>
          <button contenteditable$="[[signedIn]]" class="blue">{{siteContent.whyButton}}</button>          
        </footer>
      </section>
    </div>

    <div class="block grey double-padding" id="how">
      <section>
        <header>
          <h2 contenteditable$="[[signedIn]]">{{siteContent.howHeader}}</h2>
        </header>
        <main>
          <ol>
            <li>
              <h6 contenteditable$="[[signedIn]]">{{siteContent.step1Header}}</h6>
              <article contenteditable$="[[signedIn]]">
                {{siteContent.step1Article}}
              </article>
            </li>
            <li>
              <h6 contenteditable$="[[signedIn]]">{{siteContent.step2Header}}</h6>
              <article contenteditable$="[[signedIn]]">
                {{siteContent.step2Article}}
              </article>              
            </li>
            <li>
              <h6 contenteditable$="[[signedIn]]">{{siteContent.step3Header}}</h6>
              <article contenteditable$="[[signedIn]]">
                {{siteContent.step3Article}}
              </article>                 
            </li>            
          </ol>
        </main>
        <footer></footer>
      </section>
    </div>

    <div class="block blue" id="action">
      <section class="horizontal">
        <header class="flex2">
          <h3 contenteditable$="[[signedIn]]">{{siteContent.actionHeader}}</h3>
        </header>
        <footer>
          <button contenteditable$="[[signedIn]]">{{siteContent.actionButton}}</button>
        </footer>
      </section>
    </div>

    <div class="block green" id="about">
      <section>
        <header>
          <h2 contenteditable$="[[signedIn]]">{{siteContent.aboutHeader}}</h2>
        </header>
        <main>
          <ol>
            <li>
              <h6 contenteditable$="[[signedIn]]">{{siteContent.aboutCase1Header}}</h6>
              <article contenteditable$="[[signedIn]]">
                {{siteContent.aboutCase1Article}}
              </article>
            </li>
            <li>
              <h6 contenteditable$="[[signedIn]]">{{siteContent.aboutCase2Header}}</h6>
              <article contenteditable$="[[signedIn]]">
                {{siteContent.aboutCase2Article}}
              </article>              
            </li>
            <li>
              <h6 contenteditable$="[[signedIn]]">{{siteContent.aboutCase3Header}}</h6>
              <article contenteditable$="[[signedIn]]">
                {{siteContent.aboutCase3Article}}
              </article>                  
            </li>            
          </ol>
        </main>
        <footer></footer>
      </section>
    </div>

    <div class="block" id="testimonials">
      <section>
        <content-slider
          current-index="{{currentTestimonialIndex}}"
          number-of-slides="{{numberOfTestimonials}}"
          animation-duration="250"
        >
          <div>
            <blockquote>De woorden van Need Words waren een feest van herkenning. Ik kreeg niet alleen een tekst, het gaf me nieuwe focus in een chaotische tijd</blockquote>
            <need-words-avatar
              name="Marcel C. de Vries"
              image-url="https://i.vimeocdn.com/portrait/3843863_300x300"
            ></need-words-avatar>
          </div>
          <div>
            <blockquote>De woorden van Need Words waren een feest van herkenning. Ik kreeg niet alleen een tekst, het gaf me nieuwe focus in een chaotische tijd</blockquote>
            <need-words-avatar
              name="Marcel C. de Vries"
              image-url="https://i.vimeocdn.com/portrait/3843863_300x300"
            ></need-words-avatar>
          </div>
          <div>
            <blockquote>De woorden van Need Words waren een feest van herkenning. Ik kreeg niet alleen een tekst, het gaf me nieuwe focus in een chaotische tijd</blockquote>
            <need-words-avatar
              name="Marcel C. de Vries"
              image-url="https://i.vimeocdn.com/portrait/3843863_300x300"
            ></need-words-avatar>
          </div>
          <div>
            <blockquote>De woorden van Need Words waren een feest van herkenning. Ik kreeg niet alleen een tekst, het gaf me nieuwe focus in een chaotische tijd</blockquote>
            <need-words-avatar
              name="Marcel C. de Vries"
              image-url="https://i.vimeocdn.com/portrait/3843863_300x300"
            ></need-words-avatar>
          </div>
        </content-slider>

        <ul id="testimonials-nav">
        <template is="dom-repeat" items="[[_testomonialNavItems]]">
          <li on-tap="_handleTapTestimonialNavItem" data-active$="[[_navItemActive(index, currentTestimonialIndex)]]"></li>
        </template>
        </ul>

      </section>
    </div>

    <div class="block green" id="about">
      <section>
        <header>
          <h2 contenteditable$="[[signedIn]]">{{siteContent.casesHeader}}</h2>
        </header>
        <main>
          <article contenteditable$="[[signedIn]]">
            {{siteContent.casesArticle}}
          </article>
        </main>
        <footer></footer>
      </section>
    </div>

    <!-- foto -->

    <div class="block grey" id="contact">
      <section>
        <header>
          <h2 contenteditable$="[[signedIn]]">{{siteContent.contactHeader}}</h2>
        </header>
        <main>
          <article contenteditable$="[[signedIn]]">
            {{siteContent.contactArticle}}
          </article>

          <input type="text" placeholder="name">
          <input type="text" placeholder="email">
          <textarea placeholder="message"></textarea>

        </main>
        <footer>
          <button contenteditable$="[[signedIn]]" class="blue">{{siteContent.contactButton}}</button>     
        </footer>
      </section>
    </div>

  </template>


  <script>
    Polymer({

      is: 'need-words-app',

      properties: {

        numberOfTestimonials: {
          type: Number
        },

        currentTestimonialIndex: {
          type: Number,
          value: 0
        },

        siteContent: {
          type: Object
        },
        
        signedIn: {
          type: Boolean,
          value: false,
          observer: '_loginSuccesful'
        },
        
        route: {
          type: Object          
        },
        
        loginPageActive: {
          type: Boolean,
          value: false          
        },

        _testomonialNavItems: {
          type: Array,
          computed: '_computeTestimonialNavItems(numberOfTestimonials)'
        },

      },

      _handleTapTestimonialNavItem: function(evt) {
        this.currentTestimonialIndex = evt.model.index;
      },

      _computeTestimonialNavItems: function(numberOfTestimonials) {
        var items = [];
        for(var i = 0;i<numberOfTestimonials;i++) {
          items.push(i);
        }
        return items;
      },

      _navItemActive: function(index, currentTestimonialIndex) {
        return index === currentTestimonialIndex;
      },

      _loginSuccesful: function (signedIn) {
        if(signedIn) return this._closeAuthDialog()
      },

      _openAuthDialog: function() {
        this.$$('#auth-dialog').open()
      },

      _closeAuthDialog: function() {
        this.$$('#auth-dialog').close()
      },

      _signOut: function () {
        this.$$('#firebase-auth').signOut()
      }

    });
  </script>
</dom-module>
